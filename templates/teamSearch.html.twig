<!DOCTYPE html>
<html lang="en">
    {{ include('header.html.twig') }}
    <body>

        <header class="header">
            <nav>
                {# Include navigation template #}
                {{ include('navigation.html.twig') }}
            </nav>
        </header>

        <main class="main">
            <div class="pageTitle" id="SearchedTeamContainer">
                <h1 class="mt-4">Search Result for {{ teamData.team_name|e }}</h1>
                <p>Here is the information for the team you searched for, including season matches and league standings.</p>
            </div>

            <section id="searchedTeamInfo">
                <h2><img src="{{ teamData.crest|e('html_attr') }}" width="50" alt="logo"> {{ teamData.team_name|e }}</h2>            
                <p>
                    <strong>{{ teamData.team_name|e }}</strong> plays in the <strong>{{ leagueName|e }}</strong> 
                    and is currently positioned <strong>{{ teamData.position }}</strong> in the standings,
                    with <strong>{{ teamData.points|e }}</strong> points 
                    and a goal difference of <strong>{{ teamData.goal_diff|e }}</strong>.
                </p>
            </section>

            <div id="LiveScoresMatches"> 
                {% for comp, matches in groupedMatches %}
                    <div class="tableContainer">
                        <h4 class="mt-3">{{ comp }}</h4>

                        <table class="table table-striped table-dark table-hover mt-2">
                            <thead>
                                <tr>
                                    <th>Home</th>
                                    <th>Away</th>
                                    <th>Score</th>
                                    <th>Minute</th>
                                    <th>Kickoff</th>
                                </tr>
                            </thead>
                            <tbody>
                                {% for m in matches %}
                                    <tr>
                                        {# |e('html_attr') is correct for URLs in attributes. Prevents attribute injection. #}
                                        <td><img class="scoreteamCrest" src="{{ m.homeTeamCrest|e('html_attr') }}" alt="logo"> {{ m.homeTeam.name|e }}</td>
                                        <td><img class="scoreteamCrest" src="{{ m.awayTeamCrest|e('html_attr') }}" alt="logo"> {{ m.awayTeam.name|e }}</td>
                                        <td>{{ m.score.fullTime.home|e }} - {{ m.score.fullTime.away|e }}</td>
                                        <td>{{ m.minute|e }}</td>
                                        <td>{{ m.utcDate|date("H:i")|e }}</td>
                                    </tr>
                                {% endfor %}
                            </tbody>
                        </table>
                    </div>
                    <br>
                {% endfor %}
            </div>

            <div id="standingsContainer" class = "tableContainer">
                <h2 class="mt-4">
                    Standings - {{ leagueName|e }}
                    <img id="leagueCrest" src="{{ leagueCrest|e('html_attr') }}" alt="{{ leagueName|e }} logo">
                </h2>

                <table class="table table-striped table-dark table-hover mt-4">
                    <tr>
                        <th>#</th>
                        <th>Team</th>
                        <th>P</th>
                        <th>W</th>
                        <th>D</th>
                        <th>L</th>
                        <th>Pts</th>
                        <th>GF</th>
                        <th>GA</th>
                        <th>GD</th>
                    </tr>

                    {% for team in standings %}
                    <tr>
                        <td>{{ team.position|e }}</td>
                        <td><img class="scoreteamCrest" src="{{ team.crest|e('html_attr') }}" alt="logo"> {{ team.team_name|e }}</td>
                        <td>{{ team.played|e }}</td>
                        <td>{{ team.won|e }}</td>
                        <td>{{ team.draw_matches|e }}</td>
                        <td>{{ team.lost|e }}</td>
                        <td>{{ team.points|e }}</td>
                        <td>{{ team.goals_for|e }}</td>
                        <td>{{ team.goals_against|e }}</td>
                        <td>{{ team.goal_diff|e }}</td>
                    </tr>
                    {% endfor %}
                </table>
            </div>
        </main>

        <footer class="footer mt-4">
            <p>Copyright Â© 2025</p>
        </footer>
        {% include 'searchScript.html.twig' %}
    </body>
</html>