<!DOCTYPE html>
<html lang="en">
    {{ include('header.html.twig') }}
    <body>

        <header class="header">
            <nav>
                {# Include navigation template #}
                {{ include('navigation.html.twig') }}
            </nav>
        </header>
        {# Main Content Section #}
        <main class = "main">
            {# Page title and description #}
            <div class="pageTitle" id="livscoreContainer">
                <h1 class="mt-4">LiveScore</h1>
                <p>Stay updated with the latest live scores from various football leagues</p>
            </div>
             {# League Selection #}
            <div id = "livescoreButtons" class=" undertilteButtons contaner" mt-5>
                <div class= "tilteButtons">
                    {# Refresh Button #}
                    <form class="livescoreForm" 'refreshButton' method="post">
                        <button class = "btn btn-primary" id= 'refresh' type="submit" name="refresh">Refresh Live Scores</button>
                    </form>
                     {# League Dropdown #}
                    <form class="livescoreForm" method="get">
                        <select name="league" onchange="this.form.submit()">
                            <option value="">All Leagues</option>
                            {# Loop through all leagues for the dropdown populate #}
                            {% for league in leagues %}
                                <option value="{{ league|e }}" {% if league == selectedLeague %}selected{% endif %}>
                                    {{ league|e }}
                                </option>
                            {% endfor %}
                        </select>
                    </form>
                </div>
            </div>
        </div>
        {# Live Scores Matches Section #}
        <div class="liveScoresMatchesContainer">
            <div class = "tableContainer">
                {# Check if there are matches today #}
                {% if groupedMatches is empty %}
                    <div class= 'empty'>
                        <p>There are no matches form the major leagues Today</p>
                    </div>
                {% else %}
                    {# Loop through countries and their competitions #}
                    {% for country, comps in groupedMatches %}
                    {# country = country name (e.g. England)
                    comps = associative array of competitions for that country (e.g. Premier league) #}
                        <div id="country-section">
                        <h2 class="mt-4">{{ country|e }}</h2>

                        {# Table of matches for this competition #}
                        {% for comp, matches in comps %}
                            <h4 class="mt-3">{{ comp|e }}</h4>

                            <table class="table table-striped table-dark table-hover mt-4">
                                <thead>
                                    <tr>
                                        <th>Home</th>       {#Home team #}
                                        <th>Away</th>       {#Away team #}
                                        <th>Score</th>      {#Score#}
                                        <th>Minute</th>     {#Game time #}
                                        <th>Kickoff</th>    {#Kick off time#}
                                    </tr>
                                </thead>
                                <tbody>
                                 {# Loop through each match and display details #}
                                    {% for m in matches %}
                                        <tr>
                                            <td><img class="scoreteamCrest" src="{{m.homeTeamCrest.crest|e('html_attr') }}" alt="logo">{{ m.homeTeam.name|e }}</td>
                                            <td><img class="scoreteamCrest" src="{{m.awayTeamCrest.crest|e('html_attr') }}" alt="logo">{{ m.awayTeam.name|e }}</td>
                                            <td>{{ m.score.fullTime.home|e}} - {{ m.score.fullTime.away|e }}</td>
                                            <td>{{ m.minute|e }}</td>
                                            <td>{{ m.utcDate|date("H:i")|e}}</td>
                                        </tr>
                                    {% endfor %}
                                </tbody>
                            </table><br>

                        {% endfor %}
                        </div>
                    {% endfor %}
                {% endif %}
            </div>
        </main>
        {# Footer Section #}
        <footer class="footer mt-4">
            <p>Copyright Â© 2025</p>
        </footer>
        {# Include search script template #}
        {% include 'searchScript.html.twig' %}
    </body>
</html>