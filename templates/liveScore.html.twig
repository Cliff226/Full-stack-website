<!DOCTYPE html>
<html lang="en">
    {{ include('header.html.twig') }}
    <body>

        <header class="header">
            <nav>
                {# Include navigation template #}
                {{ include('navigation.html.twig') }}
            </nav>
        </header>

        <main class = "main">
            <div class="pageTitle" id="livscoreContainer">
                <h1 class="mt-4">LiveScore</h1>
                <p>Stay updated with the latest live scores from various football leagues</p>
            </div>
            <div id = "livescoreButtons" class=" undertilteButtons contaner" mt-5>
                <div class= "tilteButtons">
                    <form class="livescoreForm" 'refreshButton' method="post">
                        <button class = "btn btn-primary" id= 'refresh' type="submit" name="refresh">Refresh Live Scores</button>
                    </form>
                    <form class="livescoreForm" method="get">
                        <select name="league" onchange="this.form.submit()">
                            <option value="">All Leagues</option>
                            {% for league in leagues %}
                                <option value="{{ league|e }}" {% if league == selectedLeague %}selected{% endif %}>
                                    {{ league|e }}
                                </option>
                            {% endfor %}
                        </select>
                    </form>
                </div>
            </div>
        </div>
        <div class="liveScoresMatchesContainer">
            <div class = "tableContainer">
                {% if groupedMatches is empty %}
                    <div class= 'empty'>
                        <p>There are no matches form the major leagues Today</p>
                    </div>
                {% else %}

                    {% for country, comps in groupedMatches %}
                    {# country is the key comps is the value (associative array) example 'England' => [
                    'Premier League' => [ match1, match2, ... ],#} 
                        <div id="country-section">
                        <h2 class="mt-4">{{ country|e }}</h2>

                        {% for comp, matches in comps|e %}
                            <h4 class="mt-3">{{ comp|e }}</h4>

                            <table class="table table-striped table-dark table-hover mt-4">
                                <thead>
                                    <tr>
                                        <th>Home</th>
                                        <th>Away</th>
                                        <th>Score</th>
                                        <th>Minute</th>
                                        <th>Kickoff</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    {% for m in matches %}
                                        <tr>
                                            <td><img class="scoreteamCrest" src="{{m.homeTeamCrest.crest|e('html_attr') }}" alt="logo">{{ m.homeTeam.name|e }}</td>
                                            <td><img class="scoreteamCrest" src="{{m.awayTeamCrest.crest|e('html_attr') }}" alt="logo">{{ m.awayTeam.name|e }}</td>
                                            <td>{{ m.score.fullTime.home|e}} - {{ m.score.fullTime.away|e }}</td>
                                            <td>{{ m.minute|e }}</td>
                                            <td>{{ m.utcDate|date("H:i")|e}}</td>
                                        </tr>
                                    {% endfor %}
                                </tbody>
                            </table><br>

                        {% endfor %}
                        </div>
                    {% endfor %}
                {% endif %}
            </div>
        </main>
        <footer class="footer mt-4">
            <p>Copyright Â© 2025</p>
        </footer>
        {% include 'searchScript.html.twig' %}
    </body>
</html>